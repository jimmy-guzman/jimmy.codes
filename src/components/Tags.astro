---
import { slugifyTag } from "@/utils/tag";

interface Props {
  tags: { tag: string; count: number }[];
  active?: string;
  maxVisible?: number;
}

const { tags, active, maxVisible = 7 } = Astro.props;
const visibleTags = tags.slice(0, maxVisible);
const hasMoreTags = tags.length > maxVisible;
---

<nav
  class="not-prose mb-8 flex flex-wrap justify-center gap-2"
  aria-label="Filter posts by tag"
>
  {
    visibleTags.map(({ tag }) => {
      const tagSlug = slugifyTag(tag);
      const isActive = tagSlug === active;

      return (
        <a
          href={`/blog/tags/${tagSlug}`}
          aria-label={isActive ? `Current: ${tag}` : `Filter by ${tag}`}
          aria-current={isActive ? "page" : undefined}
          data-astro-prefetch
          class:list={[
            "badge transition-colors duration-150 ease-in-out",
            "focus-visible:ring-1 focus-visible:ring-base-content focus-visible:outline-none",
            isActive ? "badge-primary" : "hover:badge-soft",
          ]}
        >
          {tag}
        </a>
      );
    })
  }
  {
    hasMoreTags && (
      <a
        href="/blog/tags"
        class="badge badge-outline transition-colors duration-150 ease-in-out hover:badge-soft focus-visible:ring-1 focus-visible:ring-base-content focus-visible:outline-none"
        data-astro-prefetch
      >
        +{tags.length - maxVisible} more
      </a>
    )
  }
</nav>
